<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <script language="javascript" src="https://www.cryptopro.ru/sites/default/files/products/cades/cadesplugin_api.js"></script>
    <script src="/libs/bower_components/jquery/dist/jquery.min.js"></script>
    <!--<script language="javascript" src="Code.js"></script>-->
</head>
<body>
    <script>
        $(function () {

            cadesplugin.then(function () {
                cadesplugin.async_spawn(function *(args) {
                    //var oSignedData = yield cadesplugin.CreateObjectAsync("CAdESCOM.CadesSignedData");
                    //var dataToSign = "dataToSign";
                    //yield oSignedData.propset_Content(dataToSign);
                    var oStore = yield cadesplugin.CreateObjectAsync("CAdESCOM.Store");
                    console.log(oStore);
                });
            });






            //var canPromise = !!window.Promise;
            //if (canPromise) {
            //    cadesplugin.then(function () {
            //        console.log("Ok promise");
            //        var canAsync = !!cadesplugin.CreateObjectAsync;
            //        if(canAsync)
            //        {
            //            console.log("async");
            //            cadesplugin.async_spawn(function *(args) {
            //                var oSignedData = yield cadesplugin.CreateObjectAsync("CAdESCOM.CadesSignedData");
            //                var dataToSign = "dataToSign";
            //                yield oSignedData.propset_Content(dataToSign);
            //            });
            //        }else
            //        {
            //            var oSignedData = cadesplugin.CreateObject("CAdESCOM.CadesSignedData");
            //            var dataToSign = "dataToSign";
            //            oSignedData.Content = dataToSign;
            //        }
            //    },
            //           function (error) {
            //               console.log("Error");
            //           }
            //   );
            //} else {
            //    window.addEventListener("message", function (event) {
            //        if (event.data == "cadesplugin_loaded") {
            //            console.log("Ok");
            //        } else if (event.data == "cadesplugin_load_error") {
            //            console.log("Error");
            //        }
            //    },
            //    false);
            //    window.postMessage("cadesplugin_echo_request", "*");
        });
    </script>
</body>
</html>
